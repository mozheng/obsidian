æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ä¹‹å‰çš„æ¨ç†æµç¨‹ï¼ŒVDMçš„ä¼˜åŒ–æºäºå…¬å¼ï¼ˆ1.62ï¼‰çš„ä¸‰é¡¹ï¼š
$$
\underbrace{\mathbb{E}_{q(x_{1}|x_0)} [ \log p_\theta(x_0 | x_1)]}_{é‡å»ºé¡¹} -   \underbrace{D_{KL}(q(x_T|x_0)||p(x_T))}_{å…ˆéªŒåŒ¹é…é¡¹} - \underbrace{\sum_{t=2}^{T} \mathbb{E}_{q(x_t|x_0)} [D_{KL}(q(x_{t-1}|x_t,x_0)||p_\theta(x_{t-1}|x_t))]}_{å»å™ªåŒ¹é…é¡¹}
$$
å› ä¸ºå‰ä¸¤é¡¹ä¸æ—¶é—´tæ— å…³ï¼Œå…¬å¼ï¼ˆ1.62ï¼‰ä¸­æœ€é‡è¦çš„æ˜¯ç¬¬ä¸‰é¡¹
$$
\mathbb{E}_{q(x_t|x_0)} [D_{KL}(q(x_{t-1}|x_t,x_0)||p_\theta(x_{t-1}|x_t))]
$$
æˆä¸ºä¼˜åŒ–é‡ç‚¹ã€‚åœ¨å…¬å¼ï¼ˆ1.100ï¼‰ä¸­ï¼Œæå‡ºäº†åŸºäºå›¾åƒç”Ÿæˆçš„VDMä¼˜åŒ–æ¨¡å¼ã€‚å®ƒå¯ä»¥é€šè¿‡ç®€å•çš„ç¥ç»ç½‘ç»œæ¥è®­ç»ƒï¼Œä»æ‚ä¹±å™ªå£° $x_t$ å¼€å§‹ï¼Œç»è¿‡ $t$ æ­¥æ¥é¢„æµ‹åŸå§‹å›¾åƒ $x_0$ ã€‚è¿™ç§ä¼˜åŒ–ç­–ç•¥å¾ˆç›´æ¥ï¼Œä½†æˆ‘ä»¬è¿˜æœ‰å…¶ä»–ä¸¤ç§çš„ä¼˜åŒ–ç­–ç•¥ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

| ä¼˜åŒ–ç­–ç•¥ | ä¼˜åŒ–å…¬å¼                                                                                                                                                                                                       | ç½‘ç»œå»ºæ¨¡é¡¹                             | å«ä¹‰                  |
| :--- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------- | ------------------- |
| å›¾åƒç”Ÿæˆ | $\arg\min_{{{\theta}}} \frac{1} {2Ïƒ_q^2 (t)}\frac{\bar{{\alpha}}_{t-1}(1-{\alpha}_t)^2}{(1-\bar{{\alpha}}_{t})^2} \left[\left \Vert\hat{{{x}}}_{{{\theta}} }({{x}}_t,t)-{{x}}_{0} \right \Vert_2^2\right]$ | ${\hat{x}}_{{\theta}}({{x}}_t,t)$ | ã€ä¼¼ç„¶è§£é‡Šã€‘ç”Ÿæˆå…·æœ‰æœ€å¤§ä¼¼ç„¶çš„åŸå§‹å›¾åƒ |
| å™ªå£°é¢„æµ‹ | $\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \frac{(1-{\alpha}_t)^2}{(1-\bar{{\alpha}}_t)\alpha_t} \left[ \Big\Vert \epsilon_0 - \hat{\epsilon}_\theta(x_t,t) \Big\Vert_2^2 \right]$                        | $\hat{\epsilon}_\theta(x_t,t)$    | ã€ä¼¼ç„¶è§£é‡Šã€‘ç”Ÿæˆæœ€å¤§ä¼¼ç„¶çš„åˆå§‹å™ªå£°   |
| åˆ†æ•°å‡½æ•° | $\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \frac{(1-{\alpha}_t)^2}{\alpha_t} \left[\Vert s_\theta(x_t,t) - âˆ‡ \logâ¡ ğ‘(x_t)\Vert_2^2 \right]$                                                              | $s_\theta(x_t,t)$                 | ã€åˆ†æ•°è§£é‡Šã€‘å¦‚ä½•ç§»åŠ¨ä»¥æœ€å¤§åŒ–å¯¹æ•°æ¦‚ç‡  |
ä¸‹é¢æˆ‘ä»¬ä¼šåˆ†åˆ«æ¨ç†å„ç§ä¼˜åŒ–æ–¹æ¡ˆ
### 6.1 åŸºäºå™ªå£°é¢„æµ‹çš„ä¼˜åŒ–ç­–ç•¥
åœ¨ç­‰å¼ï¼ˆ1.72ï¼‰ $x_t =\sqrt{\overline{\alpha}_t}x_0 + \sqrt{1-\overline{\alpha}_t}\epsilon_0$ä¸­ï¼Œå°† $x_0$ çš„æ¨å¯¼å˜æˆï¼š
$$
x_0 = \frac{x_t-\sqrt{1-\bar{\alpha}_t}\epsilon_0}{\sqrt{\bar{\alpha}_t}} \tag{1.105}
$$
ä»£å…¥å…¬å¼ï¼ˆ1.88ï¼‰æ¨å¯¼çš„çœŸå®å»å™ªè½¬ç§»å‡å€¼ $Î¼_ğ‘(ğ‘¥_ğ‘¡,ğ‘¥_0)$ ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°æ¨å¯¼ä¸ºï¼š
$$
\begin{align}
\mu_q(x_t,x_0)&=\frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t+\sqrt{\bar{{\alpha}}_{t-1}}(1-{\alpha}_t){{x}}_{0}}{1-\bar{{\alpha}}_{t}} \tag{1.106} \\
&=\frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t+\sqrt{\bar{{\alpha}}_{t-1}}(1-{\alpha}_t)\frac{x_t-\sqrt{1-\bar{\alpha}_t}\epsilon_0}{\sqrt{\bar{\alpha}_t}}}{1-\bar{{\alpha}}_{t}} \tag{1.107} \\
&=\frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t+(1-{\alpha}_t)\frac{x_t-\sqrt{1-\bar{\alpha}_t}\epsilon_0}{\sqrt{\alpha_t}}}{1-\bar{{\alpha}}_{t}} \tag{1.108} \\
&=\frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t}{1-\bar{{\alpha}}_{t}} +
\frac{(1-{\alpha}_t)x_t}{(1-\bar{{\alpha}}_t)\sqrt{\alpha_t}} - \frac{(1-{\alpha}_t)\sqrt{1-\bar{\alpha}_t}\epsilon_0}{(1-\bar{{\alpha}}_t)\sqrt{\alpha_t}} \tag{1.109} \\
&=\Big(\frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1})}{1-\bar{{\alpha}}_{t}} +
\frac{1-{\alpha}_t}{(1-\bar{{\alpha}}_t)\sqrt{\alpha_t}}\Big)x_t - \frac{(1-{\alpha}_t)\sqrt{1-\bar{\alpha}_t}}{(1-\bar{{\alpha}}_t)\sqrt{\alpha_t}}\epsilon_0 \tag{1.110} \\
&= \Big(\frac{{\alpha}_t(1-\bar{{\alpha}}_{t-1})}{(1-\bar{{\alpha}}_{t})\sqrt{\alpha}_t} +
\frac{1-{\alpha}_t}{(1-\bar{{\alpha}}_t)\sqrt{\alpha_t}}\Big)x_t - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\epsilon_0 \tag{1.111} \\
&= \frac{\alpha_t - \bar{\alpha}_t+1-{\alpha}_t}{(1-\bar{{\alpha}}_t)\sqrt{\alpha_t}}x_t - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\epsilon_0 \tag{1.112} \\
&= \frac{1 - \bar{\alpha}_t}{(1-\bar{{\alpha}}_t)\sqrt{\alpha_t}}x_t - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\epsilon_0 \tag{1.113} \\
&= \frac{1}{\sqrt{\alpha_t}}x_t - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\epsilon_0 \tag{1.114} \\
\end{align}
$$
å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡æ ¹æ®æ¨¡ä»¿åŸåˆ™ï¼Œç”¨æœªçŸ¥ $x_0$ å€¼çš„**è¿‘ä¼¼å»å™ªåˆ†å¸ƒ** $p_Î¸(x_{tâˆ’1}|x_t)$ æ¥è¿‘ä¼¼å·²çŸ¥åŸå§‹å›¾ç‰‡ $x_0$ çš„**çœŸå€¼å»å™ªåˆ†å¸ƒ** $q(x_{tâˆ’1}|x_t,x_0)$ ï¼Œè®¾ç½®è¿‘è§†å»å™ªå‡å€¼ $\mu_\theta(x_t,t)$ ä¸ºï¼š
$$
\mu_\theta(x_t,t) = \frac{1}{\sqrt{\alpha_t}}x_t - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\hat{\epsilon}_\theta(x_t,t) \tag{1.115}
$$
å…¬å¼ï¼ˆ1.95ï¼‰çš„é€€ç†å¯ä»¥æ”¹ä¸ºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š
$$
\begin{align}
&~~~~\arg\min_{{{\theta}}} D_{\text{KL}}(q({{x}}_{t-1}|{{x}}_t,{{x}}_0)\Vert p_{{\theta}}({{x}}_{t-1}|{{x}}_t))\\
&=\arg\min_{{{\theta}}} D_{\text{KL}}(\mathcal{N} ({{x}}_{t-1}; Î¼_q, Î£_q(t)) \Vert \mathcal{N} ({{x}}_{t-1}; Î¼_{{\theta}}, Î£_q(t))) \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \left[ \Vert {\mu}_{{\theta}} âˆ’ {\mu}_q \Vert_2^2 \right] \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \left[ \Big\Vert \frac{1}{\sqrt{\alpha_t}}x_t - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\hat{\epsilon}_\theta(x_t,t) âˆ’ \frac{1}{\sqrt{\alpha_t}}x_t + \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\epsilon_0 \Big\Vert_2^2 \right] \tag{1.116} \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \left[ \Big\Vert \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\epsilon_0 - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}\hat{\epsilon}_\theta(x_t,t) \Big\Vert_2^2 \right] \tag{1.117} \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \left[ \Big\Vert \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}(\epsilon_0 - \hat{\epsilon}_\theta(x_t,t)) \Big\Vert_2^2 \right] \tag{1.118} \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \frac{(1-{\alpha}_t)^2}{(1-\bar{{\alpha}}_t)\alpha_t} \left[ \Big\Vert (\epsilon_0 - \hat{\epsilon}_\theta(x_t,t)) \Big\Vert_2^2 \right] \tag{1.119} \\
\end{align}
$$
è¿™é‡Œï¼Œ$\hat{\epsilon}_\theta(x_t,t)$ æ˜¯ä¸€ä¸ªç”¨æºå™ªå£° $\epsilon_0 \sim \mathcal{N}(\epsilon;0,I)$ æŒ‡å¯¼ $x_t$ åˆ° $x_0$ å»å™ªçš„ç¥ç»ç½‘ç»œã€‚å› æ­¤ï¼Œæˆ‘ä»¬å·²ç»è¯æ˜äº†ä¾é é€šè¿‡å­¦ä¹ åŸå§‹å›¾åƒÂ $ğ‘¥_0$Â è·å¾— VDM ç­‰åŒäºå­¦ä¹ é¢„æµ‹çš„å™ªå£°ã€‚ä¸€äº›ç ”ç©¶å®è¯ï¼Œä½¿ç”¨è¿™ç§é¢„æµ‹å™ªå£°çš„æ–¹æ¡ˆå¯ä»¥å¾—åˆ°æ›´å¥½çš„ç»“æœã€‚
### 6.2 åŸºäºåˆ†æ•°å‡½æ•°çš„ä¼˜åŒ–ç­–ç•¥

ä¸ºäº†å¾—å‡ºå˜åˆ†æ‰©æ•£æ¨¡å‹çš„åˆ†æ•°å‡½æ•°çš„ä¼˜åŒ–ç­–ç•¥ï¼Œæˆ‘ä»¬å¼•å…¥ Tweedie å…¬å¼ã€‚ï¼šTweedie å…¬å¼æ¥è‡ªè´å¶æ–¯ä¼°è®¡ã€‚è´å¶æ–¯ä¼°è®¡çš„é—®é¢˜å®šä¹‰ä¸ºæ ¹æ®ä¸€äº›è§‚æµ‹æ•°æ®Â $ğ‘¥$Â æ¥ä¼°è®¡æœªçŸ¥å‚æ•°Â $ğœƒ$ï¼Œå¦‚æœç”¨å‡æ–¹è¯¯å·®(MSE)æŸå¤±å‡½æ•°æ¥è¡¡é‡ä¼°è®¡çš„å‡†ç¡®æ€§çš„è¯ï¼Œæˆ‘ä»¬å°†é—®é¢˜å»ºæ¨¡ä¸ºï¼š
$$
L= \mathbb{E}[(\hat{\theta}(x)-\theta)^2]
$$
æ•´ä¸ªé—®é¢˜æœ¬è´¨å…¶å®å°±æ˜¯æ±‚è§£ï¼Œ $x$ çš„æ¡ä»¶ä¸‹ï¼Œ $\theta$ å€¼çš„æœŸæœ›ï¼š
$$
\hat{\theta}(x)=\mathbb{E}[\theta|x]=\int \theta p(\theta|x)d\theta \tag{1.120}
$$
è€ŒTweedieå…¬å¼ï¼Œå°±æ˜¯ä¸€ç§ä¼°è®¡ $\theta$ çš„æ–¹æ¡ˆã€‚å‡è®¾ $p(x|\theta)=\mathcal{N}(\theta,\sigma^2)$ï¼Œå¯ä»¥é€šè¿‡è§‚æµ‹æ•°æ®ä¼°è®¡å‡ºå‚æ•°ğœï¼Œåˆ™æœ‰ï¼š
$$
\begin{align}
\hat{\theta}(x)=\mathbb{E}[\theta|x] &=\int \theta p(\theta|x)d\theta \\
&= x+\sigma^2\frac{d}{dx} \log p(x) \tag{1.121}
\end{align}
$$
è¿™ä¸ªå…¬å¼çš„ä¼˜ç‚¹æ˜¯ä¸€ç›´ä¿æœ‰ç€ $ğ‘(ğœƒ)$Â çš„é›å½¢è€Œæ²¡æœ‰æ¢ç©¶å®ƒçš„å…·ä½“æ ·å­ã€‚æ­¤å…¬å¼ä¸“ä¾›å·²çŸ¥æ–¹å·®ï¼Œæ±‚ä¸å‡ºæ¥å‡å€¼æ—¶ä½¿ç”¨ã€‚ä»æ•°å­¦ä¸Šè®²ï¼Œå¯¹äºæ»¡è¶³é«˜æ–¯åˆ†å¸ƒçš„å˜é‡Â $ğ‘§ \sim \mathcal{ğ‘}(ğ‘§;Î¼_ğ‘§,Î£_ğ‘§)$ï¼ŒTweedie å…¬å¼å¦‚ä¸‹ï¼š
$$
\mathbb{E}[ğœ‡_z|z]=z+ğ›´_z âˆ‡_z \logâ¡ p(z) \tag{1.122}
$$
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”ç”¨å®ƒæ¥é¢„æµ‹ç»™å®šæ ·æœ¬çš„Â $ğ‘¥_ğ‘¡$Â çš„çœŸå®åéªŒå‡å€¼ã€‚ç”±å…¬å¼ï¼ˆ1.73ï¼‰å¯çŸ¥ï¼š
$$
q(x_t|x_0)=\mathcal{N}(x_t;\sqrt{\bar{\alpha}_t}x_0,(1-\bar{\alpha}_t)I)
$$
è¿™ååˆ†ç¬¦åˆæ–¹å·®å¾ˆå¥½æ±‚ï¼Œå‡å€¼æœ‰ $x_0$ å¤ªéš¾æ±‚çš„ä¾‹å­ã€‚åˆ©ç”¨Tweedieå…¬å¼ï¼Œæˆ‘ä»¬å¾—å‡ºï¼š
$$
\mathbb{ğ¸}[ğœ‡_{x_t}|x_t]=x_t+(1-\bar{\alpha}_t)âˆ‡_{x_t} \logâ¡ ğ‘(x_t) \tag{1.123}
$$
å…¶ä¸­ï¼Œä¸ºäº†ç¬¦å·çš„ç®€æ´æ€§ï¼Œæˆ‘ä»¬å°† $âˆ‡_{x_t}\log p(x_t)$ å†™ä¸º $âˆ‡ \log p(x_t)$Â ã€‚æ ¹æ® Tweedie å…¬å¼ï¼Œç”± $ğ‘¥_ğ‘¡$ ç”Ÿæˆçš„çœŸå®å‡å€¼ $Î¼_{ğ‘¥_ğ‘¡}=\sqrt{\bar{Î±}_t}ğ‘¥_0$ ï¼Œå¯å®šä¹‰ä¸ºï¼š
$$
\begin{align}
\sqrt{\bar{Î±}_t}ğ‘¥_0 &= x_t+(1-\bar{\alpha}_t)âˆ‡_{x_t} \logâ¡ ğ‘(x_t) \tag{1.124} \\
\therefore x_0 &= \frac{x_t+(1-\bar{\alpha}_t)âˆ‡_{x_t} \logâ¡ ğ‘(x_t)} {\sqrt{\bar{Î±}_t}} \tag{1.125}
\end{align}
$$
ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¬å¼ï¼ˆ1.125ï¼‰å†æ¬¡ä»£å…¥æˆ‘ä»¬çš„çœŸå®å»å™ªè½¬ç§»å‡å€¼ $Î¼_ğ‘(ğ‘¥_ğ‘¡,ğ‘¥_0)$å¹¶æ¨å¯¼å‡ºæ–°çš„å½¢å¼ï¼š
$$
\begin{align}
\mu_q(x_t,x_0) &=\frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t+\sqrt{\bar{{\alpha}}_{t-1}}(1-{\alpha}_t){{x}}_{0}}{1-\bar{{\alpha}}_{t}} 
\tag{1.126} \\
&= \frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t+\sqrt{\bar{{\alpha}}_{t-1}}(1-{\alpha}_t)\frac{x_t+(1-\bar{\alpha}_t)âˆ‡ \logâ¡ ğ‘(x_t)} {\sqrt{\bar{Î±}_t}} }{1-\bar{{\alpha}}_{t}} \tag{1.127} \\
&= \frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t+(1-{\alpha}_t)\frac{x_t+(1-\bar{\alpha}_t)âˆ‡ \logâ¡ ğ‘(x_t)} {\sqrt{Î±_t}} }{1-\bar{\alpha}_{t}} \tag{1.128} \\
&= \frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1}){{x}}_t}{1-\bar{\alpha}_{t}} +
\frac{(1-{\alpha}_t)x_t}{(1-\bar{\alpha}_{t})\sqrt{Î±_t}} + \frac{(1-\alpha_t)(1-\bar{\alpha}_t)âˆ‡ \logâ¡ ğ‘(x_t) }{(1-\bar{\alpha}_{t})\sqrt{Î±_t}} \tag{1.129} \\
&= \Big(\frac{\sqrt{{\alpha}_t}(1-\bar{{\alpha}}_{t-1})}{1-\bar{\alpha}_{t}} +
\frac{1-{\alpha}_t}{(1-\bar{\alpha}_{t})\sqrt{Î±_t}} \Big)x_t+ \frac{1-\alpha_t}{\sqrt{Î±_t}}âˆ‡ \logâ¡ ğ‘(x_t) \tag{1.130} \\
&= \Big(\frac{{\alpha}_t(1-\bar{{\alpha}}_{t-1})}{(1-\bar{\alpha}_{t})\sqrt{{\alpha}_t}} +
\frac{1-{\alpha}_t}{(1-\bar{\alpha}_{t})\sqrt{Î±_t}} \Big)x_t+ \frac{1-\alpha_t}{\sqrt{Î±_t}}âˆ‡ \logâ¡ ğ‘(x_t) \tag{1.131} \\
&= \frac{{\alpha}_t -\bar{{\alpha}}_{t}+ 1-{\alpha}_t}{(1-\bar{\alpha}_{t})\sqrt{Î±_t}}x_t+ \frac{1-\alpha_t}{\sqrt{Î±_t}}âˆ‡ \logâ¡ ğ‘(x_t) \tag{1.132} \\
&= \frac{ 1-\bar{{\alpha}}_{t}}{(1-\bar{\alpha}_{t})\sqrt{Î±_t}}x_t+ \frac{1-\alpha_t}{\sqrt{Î±_t}}âˆ‡ \logâ¡ ğ‘(x_t) \tag{1.133} \\
&= \frac{ 1}{\sqrt{Î±_t}}x_t+ \frac{1-\alpha_t}{\sqrt{Î±_t}}âˆ‡ \logâ¡ ğ‘(x_t) \tag{1.134} \\
\end{align}
$$
å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®è¿‘è§†å»å™ªå‡å€¼ $\mu_\theta(x_t,t)$ ä¸ºï¼š
$$
\mu_\theta(x_t,t) = \frac{1}{\sqrt{\alpha_t}}x_t - \frac{1-{\alpha}_t}{\sqrt{1-\bar{{\alpha}}_t}\sqrt{\alpha_t}}s_\theta(x_t,t) \tag{1.135}
$$
ç›¸åº”çš„ä¼˜åŒ–é—®é¢˜å¯ä»¥å˜ä¸ºï¼š
$$
\begin{align}
&~~~~\arg\min_{{{\theta}}} D_{\text{KL}}(q({{x}}_{t-1}|{{x}}_t,{{x}}_0)\Vert p_{{\theta}}({{x}}_{t-1}|{{x}}_t))\\
&=\arg\min_{{{\theta}}} D_{\text{KL}}(\mathcal{N} ({{x}}_{t-1}; Î¼_q, Î£_q(t)) \Vert \mathcal{N} ({{x}}_{t-1}; Î¼_{{\theta}}, Î£_q(t))) \tag{1.136} \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \left[ \Big\Vert \frac{1}{\sqrt{\alpha_t}}x_t + \frac{1-{\alpha}_t}{\sqrt{\alpha_t}}s_\theta(x_t,t) âˆ’ \frac{1}{\sqrt{\alpha_t}}x_t - \frac{1-{\alpha}_t}{\sqrt{\alpha_t}}âˆ‡ \logâ¡ ğ‘(x_t)\Big\Vert_2^2 \right] \tag{1.137} \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \left[ \Big\Vert  \frac{1-{\alpha}_t}{\sqrt{\alpha_t}}s_\theta(x_t,t) - \frac{1-{\alpha}_t}{\sqrt{\alpha_t}}âˆ‡ \logâ¡ ğ‘(x_t)\Big\Vert_2^2 \right] \tag{1.138} \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \left[ \Big\Vert  \frac{1-{\alpha}_t}{\sqrt{\alpha_t}}(s_\theta(x_t,t) - âˆ‡ \logâ¡ ğ‘(x_t))\Big\Vert_2^2 \right] \tag{1.139} \\
&=\arg\min_{{{\theta}}} \frac{1}{2Ïƒ_q^2 (t)} \frac{(1-{\alpha}_t)^2}{\alpha_t} \left[\Vert s_\theta(x_t,t) - âˆ‡ \logâ¡ ğ‘(x_t)\Vert_2^2 \right] \tag{1.140} \\
\end{align}
$$
è¿™é‡Œï¼Œ$s_Î¸(x_t, t)$ å¯ä»¥æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œç”¨æ¥å­¦ä¹ é¢„æµ‹åˆ†æ•°å‡½æ•°ï¼ˆscore functionï¼‰ $âˆ‡_{x_t} \log  p(x_t)$ã€‚ $âˆ‡_{x_t} \log  p(x_t)$ å°±æ˜¯åˆ†æ•°å‡½æ•°ï¼Œ å…¶æ€§è´¨åé¢ä¼šè¯¦ç»†é˜è¿°ã€‚æ•é”çš„è¯»è€…ä¼šæ³¨æ„åˆ°ï¼Œåˆ†æ•°å‡½æ•° $âˆ‡ \logâ¡ p(x_t)$ åœ¨å½¢å¼ä¸Šä¸æºå™ªå£° $ğœ–_0$ éå¸¸ç›¸ä¼¼ã€‚å°†Tweedieå…¬å¼ï¼ˆ1.125ï¼‰ä¸é‡å‚æ•°åŒ–æŠ€å·§å…¬å¼ï¼ˆ1.105ï¼‰ç»“åˆèµ·æ¥ï¼Œå¯ä»¥æ˜ç¡®åœ°å±•ç¤ºè¿™ä¸€ç‚¹ï¼š
$$
\begin{align}
x_0 = \frac{x_t+(1-\bar{\alpha}_t)âˆ‡ \logâ¡ ğ‘(x_t)} {\sqrt{\bar{Î±}_t}} &= \frac{x_t-\sqrt{1-\bar{\alpha}_t}\epsilon_0}{\sqrt{\bar{\alpha}_t}} \tag{1.141} \\
\therefore (1-\bar{\alpha}_t)âˆ‡ \logâ¡ ğ‘(x_t) &= -\sqrt{1-\bar{\alpha}_t}\epsilon_0 \tag{1.142} \\
âˆ‡ \logâ¡ ğ‘(x_t) &= - \frac{1}{\sqrt{1-\bar{\alpha}_t}}\epsilon_0 \tag{1.143} \\
\end{align}
$$
ä¸¤è€…å­˜åœ¨ä¸€ä¸ªéšæ—¶é—´å˜åŒ–çš„å¸¸æ•°é¡¹ï¼åˆ†æ•°å‡½æ•°è¡¡é‡äº†åœ¨æ•°æ®ç©ºé—´ä¸­å¦‚ä½•ç§»åŠ¨ä»¥æœ€å¤§åŒ–å¯¹æ•°æ¦‚ç‡ã€‚ç›´è§‚åœ°è¯´ï¼Œç›¸å¯¹äºæ­£å‘çš„å™ªå£°è¢«æ·»åŠ åˆ°åŸå§‹å›¾åƒçš„æ“ä½œï¼Œåæ–¹å‘"å»å™ªå£°"å°†æ˜¯æé«˜åç»­å¯¹æ•°æ¦‚ç‡çš„æœ€ä½³æ›´æ–°ã€‚æˆ‘ä»¬ç”¨æ•°å­¦è¯æ˜è¯å®äº†è¿™ç§ç›´è§‰ï¼šå­¦ä¹ æ¨¡æ‹Ÿåˆ†æ•°å‡½æ•°ç­‰ä»·äºæ¨¡æ‹Ÿæºå™ªå£°çš„ç›¸åæ•°ï¼ˆå·®ä¸€ä¸ªç¼©æ”¾å› å­ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾—å‡ºäº†ä¸‰ä¸ªç­‰æ•ˆçš„ä¼˜åŒ–VDMçš„ç›®æ ‡ï¼šå­¦ä¹ ç¥ç»ç½‘ç»œé¢„æµ‹åŸå§‹å›¾åƒ $ğ‘¥_0$ï¼›å­¦ä¹ ç¥ç»ç½‘ç»œé¢„æµ‹æºå™ªå£°Â $ğœ–_0$ï¼›å­¦ä¹ ä¸€å®šå™ªå£°æ°´å¹³ä¸‹çš„å›¾åƒåˆ†æ•°å‡½æ•° $âˆ‡ \logâ¡ p(x_t)$ã€‚é€šè¿‡éšæœºé‡‡æ ·æ—¶é—´æ­¥é•¿ $ğ‘¡$ å¹¶ä½¿é¢„æµ‹ç»“æœä¸åŸºå‡†çœŸå€¼ç›®æ ‡çš„èŒƒæ•°æœ€å°åŒ–ï¼Œå¯ä»¥å¯¹VDMè¿›è¡Œå¯æ‰©å±•çš„è®­ç»ƒã€‚
